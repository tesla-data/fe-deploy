(function(e){function t(t){for(var a,s,c=t[0],o=t[1],l=t[2],u=0,d=[];u<c.length;u++)s=c[u],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&d.push(n[s][0]),n[s]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);v&&v(t);while(d.length)d.shift()();return i.push.apply(i,l||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],a=!0,s=1;s<r.length;s++){var o=r[s];0!==n[o]&&(a=!1)}a&&(i.splice(t--,1),e=c(c.s=r[0]))}return e}var a={},n={app:0},i=[];function s(e){return c.p+"js/"+({about:"about"}[e]||e)+"."+{about:"73930451"}[e]+".js"}function c(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.e=function(e){var t=[],r=n[e];if(0!==r)if(r)t.push(r[2]);else{var a=new Promise((function(t,a){r=n[e]=[t,a]}));t.push(r[2]=a);var i,o=document.createElement("script");o.charset="utf-8",o.timeout=120,c.nc&&o.setAttribute("nonce",c.nc),o.src=s(e);var l=new Error;i=function(t){o.onerror=o.onload=null,clearTimeout(u);var r=n[e];if(0!==r){if(r){var a=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+a+": "+i+")",l.name="ChunkLoadError",l.type=a,l.request=i,r[1](l)}n[e]=void 0}};var u=setTimeout((function(){i({type:"timeout",target:o})}),12e4);o.onerror=o.onload=i,document.head.appendChild(o)}return Promise.all(t)},c.m=e,c.c=a,c.d=function(e,t,r){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(r,a,function(t){return e[t]}.bind(null,a));return r},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw console.error(e),e};var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var v=l;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},1216:function(e,t,r){},2155:function(e,t,r){"use strict";var a=r("39ac"),n=r.n(a);n.a},"386d":function(e,t,r){},"39ac":function(e,t,r){},"4b3f":function(e,t,r){"use strict";var a=r("4e48"),n=r.n(a);n.a},"4e48":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("4de4"),r("b680"),r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",[r("v-main",[r("router-view"),e.loadingMsg||e.error?r("v-card",{staticClass:"bottom",attrs:{light:"",loading:!!e.loadingMsg}},[r("v-card-title",{staticClass:"text-center"},[e._v(e._s(e.loadingMsg||e.error&&"错误"))]),r("v-card-text",{staticClass:"text-center"},[e._v(" "+e._s(e.error)+" "),r("br"),r("v-btn",{on:{click:e.clearError}},[e._v(e._s(e.error?"关闭":"取消"))])],1)],1):e._e()],1)],1)},i=[],s=(r("ac1f"),r("5319"),r("5530")),c=r("2f62"),o={name:"App",computed:Object(s["a"])({},Object(c["d"])(["user","loadingMsg","error","requests"])),methods:Object(s["a"])({},Object(c["b"])(["retry","clearError"])),beforeMount:function(){this.$vuetify.theme.dark=!0,this.user.user||this.$router.replace("/login")}},l=o,u=(r("2155"),r("2877")),v=r("6544"),d=r.n(v),h=r("7496"),f=r("8336"),p=r("b0af"),m=r("99d9"),g=r("f6c4"),b=Object(u["a"])(l,n,i,!1,null,"34031f59",null),_=b.exports;d()(b,{VApp:h["a"],VBtn:f["a"],VCard:p["a"],VCardText:m["a"],VCardTitle:m["b"],VMain:g["a"]});r("d3b7");var w=r("8c4f"),x=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[e.vehicleData?r("v-row",[r("v-col",{staticClass:"text-center",on:{click:e.getVehicleState}},[r("b",[e._v(e._s(e.vehicleData.display_name))]),e._v(" "),r("v-icon",{attrs:{"x-small":""}},[e._v("mdi-refresh")])],1)],1):e._e(),e.vehicleData.vehicle_state?r("v-row",[r("v-col",{attrs:{cols:"7"}},["Charging"===e.state?r("charging"):e.state?r("driving"):r("parked")],1),r("v-col",{attrs:{cols:"5"}},[r("battery")],1)],1):e._e(),r("br"),r("v-divider"),e.vehicleData.vehicle_state?r("div",{staticClass:"text-center"},[r("br"),e._v(" "+e._s(e.model)),r("br"),e._v(" "+e._s(e._f("km")(e.vehicleData.vehicle_state.odometer))),r("br"),e._v(" 版本："+e._s(e.vehicleData.vehicle_state.car_version)+" ")]):e._e()],1)},O=[],j=(r("c975"),r("1276"),r("96cf"),r("1da1")),y=r("b85c"),V=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:{battery:!0,offline:!e.isOnline},style:{height:(e.height||40)+"px"}},[r("div",{staticClass:"left text-center",style:{"line-height":(e.height||40)+"px"}},[r("div",{staticClass:"percent",style:{right:100-e.battery_level+"%"}}),r("span",[e._v(" "+e._s(e._f("km")(e.battery_range))+"/"+e._s(e._f("km")(e.totalRange))+" "+e._s(e.battery_level)+"% ")])]),r("div",{staticClass:"right top"}),r("div",{staticClass:"right middle"}),r("div",{staticClass:"right bottom"})])},k=[],D={name:"Battery",props:["height"],computed:Object(s["a"])(Object(s["a"])({},Object(c["c"])(["isOnline","vehicleData"])),{},{battery_range:function(){return this.vehicleData.charge_state.battery_range},battery_level:function(){return this.vehicleData.charge_state.battery_level},totalRange:function(){return this.battery_range/this.battery_level*100}})},C=D,R=(r("4b3f"),Object(u["a"])(C,V,k,!1,null,"1f6b5925",null)),S=R.exports,M=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",[r("v-card-title",[e._v("P "+e._s(e.chargingState))]),r("v-card-text",[r("v-row",{attrs:{dense:""}},[r("v-col",{attrs:{cols:"2"}},[r("v-icon",{attrs:{small:""}},[e._v("mdi-lightning-bolt")])],1),r("v-col",{attrs:{cols:"10"}},[e._v(" "+e._s(e._f("km")(e.state.charge_rate))+"/h | "+e._s(e.state.charger_power)+"kw"),r("br"),e._v(" +"+e._s(e._f("km")(e.state.charge_miles_added_ideal))+" | +"+e._s(e.state.charge_energy_added)+"kwh ")])],1),e.state.time_to_full_charge>0?r("v-row",{attrs:{dense:""}},[r("v-col",{attrs:{cols:"2"}},[r("v-icon",{attrs:{small:""}},[e._v("mdi-clock")])],1),r("v-col",{attrs:{cols:"10"}},[e._v(e._s(e._f("hour")(e.state.time_to_full_charge)))])],1):e._e()],1)],1)},q=[],E={name:"Charging",computed:Object(s["a"])(Object(s["a"])({},Object(c["c"])(["vehicleData"])),{},{state:function(){return this.vehicleData.charge_state},chargingState:function(){var e=this.state.charging_state;return"Charging"===e?"充电中":"Complete"===e?"充电完成":e+""}})},P=E,T=r("62ad"),$=r("132d"),L=r("0fd9"),I=Object(u["a"])(P,M,q,!1,null,"decf22ca",null),U=I.exports;d()(I,{VCard:p["a"],VCardText:m["a"],VCardTitle:m["b"],VCol:T["a"],VIcon:$["a"],VRow:L["a"]});var B=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",[r("v-card-title",{staticClass:"title"},[r("span",{class:{active:"P"===e.state.shift_state}},[e._v("P")]),r("span",{class:{active:"R"===e.state.shift_state}},[e._v("R")]),r("span",{class:{active:"N"===e.state.shift_state}},[e._v("N")]),r("span",{class:{active:"D"===e.state.shift_state}},[e._v("D")])]),r("v-card-text",[r("h1",{staticClass:"speed"},[e._v(e._s(e._f("km")(e.state.speed||0))+"/h")])])],1)},J=[],N={name:"Driving",computed:Object(s["a"])(Object(s["a"])({},Object(c["c"])(["vehicleData"])),{},{state:function(){return this.vehicleData.drive_state}})},A=N,F=(r("683a"),Object(u["a"])(A,B,J,!1,null,"e793b6b2",null)),H=F.exports;d()(F,{VCard:p["a"],VCardText:m["a"],VCardTitle:m["b"]});var X=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",[r("v-card-title",[e._v("P 驻车")]),r("v-card-text",[r("v-row",{attrs:{dense:""}},[e._v(e._s(e.state.locked?"已":"未")+"锁车")])],1)],1)},Y=[],z={name:"Parked",computed:Object(s["a"])(Object(s["a"])({},Object(c["c"])(["vehicleData"])),{},{state:function(){return this.vehicleData.vehicle_state}})},G=z,K=Object(u["a"])(G,X,Y,!1,null,"b11d4b96",null),Q=K.exports;d()(K,{VCard:p["a"],VCardText:m["a"],VCardTitle:m["b"],VRow:L["a"]});var W={MDLS:"Model S",MDL3:"Model 3",MDLX:"Model X",MDLY:"Model Y"},Z={name:"Home",components:{Charging:U,Driving:H,Parked:Q,Battery:S},comments:{Battery:S},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(c["d"])(["user"])),Object(c["c"])(["vehicleData"])),{},{state:function(){var e=this.vehicleData.charge_state.charging_state;return["Charging","Complete"].indexOf(e)>=0?"Charging":this.vehicleData.drive_state.shift_state},model:function(){var e,t=this.vehicleData.option_codes&&this.vehicleData.option_codes.split(","),r=Object(y["a"])(t);try{for(r.s();!(e=r.n()).done;){var a=e.value;if(W[a])return W[a]}}catch(n){r.e(n)}finally{r.f()}return""}}),methods:Object(s["a"])({},Object(c["b"])(["listVehicles","getVehicleState"])),beforeMount:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.user.user){t.next=3;break}return t.next=3,e.listVehicles();case 3:case"end":return t.stop()}}),t)})))()}},ee=Z,te=r("a523"),re=r("ce7e"),ae=Object(u["a"])(ee,x,O,!1,null,null,null),ne=ae.exports;d()(ae,{VCol:T["a"],VContainer:te["a"],VDivider:re["a"],VIcon:$["a"],VRow:L["a"]});var ie=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{"fill-height":""}},[r("v-form",{ref:"form",staticClass:"login text-center",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-text-field",{attrs:{placeholder:"email",rules:e.emailRules},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),r("v-text-field",{attrs:{placeholder:"password",type:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),r("v-btn",{attrs:{color:"primary",disabled:!!e.loadingMsg||!e.valid},on:{click:e.login}},[e._v("登陆")])],1)],1)},se=[],ce={name:"Login",computed:Object(s["a"])({},Object(c["d"])(["loadingMsg","error"])),data:function(){return{valid:!1,email:"",emailRules:[function(e){return!!e||"E-mail is required"}],password:"",passwordRules:[function(e){return!!e||"Password is required"}]}},methods:{login:function(){var e=this;return Object(j["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.email,a=e.password,t.next=3,e.$store.dispatch("login",{email:r,password:a});case 3:if(e.error){t.next=6;break}return t.next=6,e.$router.replace("/");case 6:case"end":return t.stop()}}),t)})))()}}},oe=ce,le=(r("5d1e"),r("4bd4")),ue=r("8654"),ve=Object(u["a"])(oe,ie,se,!1,null,"1fb3222b",null),de=ve.exports;d()(ve,{VBtn:f["a"],VContainer:te["a"],VForm:le["a"],VTextField:ue["a"]}),a["a"].use(w["a"]);var he=[{path:"/",name:"Home",component:ne},{path:"/login",name:"Login",component:de},{path:"/about",name:"About",component:function(){return r.e("about").then(r.bind(null,"f820"))}}],fe=new w["a"]({routes:he}),pe=fe,me=r("3835"),ge=(r("7db0"),r("8934"));r("a125").urlBase="https://api.i43.io/tesla";var be="user",_e="vehicle",we=JSON.parse(window.localStorage.getItem(be)||"null"),xe=window.localStorage.getItem(_e),Oe=JSON.parse(window.localStorage.getItem(xe)||"{}");delete Oe.state;var je={state:{user:we&&Date.now()<1e3*(we.created_at+we.expires_in+3600)&&new ge["User"](we),vehicles:[],currentVehicleVin:xe,lastUpdate:0,vehicleData:Oe},getters:{vehicle:function(e){return e.vehicles.find((function(t){return t.data.vin===e.currentVehicleVin}))},vehicleData:function(e){return e.vehicleData},isOnline:function(e){return e.lastUpdate+6e4>Date.now()&&"online"===e.vehicleData.state}},mutations:{setVehicleData:function(e,t){a["a"].set(e,"vehicleData",t),window.localStorage.setItem(t.vin,JSON.stringify(t)),e.lastUpdate=Date.now()}},actions:{login:function(e,t){return Object(j["a"])(regeneratorRuntime.mark((function r(){var a,n,i,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.dispatch,n=e.state,i=t.email,s=t.password,r.next=4,a("request",{request:[Object(j["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ge["oauth"].login(i,s);case 2:t=e.sent,window.localStorage.setItem(be,JSON.stringify(t.token)),n.user=new ge["User"](t.token);case 5:case"end":return e.stop()}}),e)}))),"登陆中"],retry:!1});case 4:case"end":return r.stop()}}),r)})))()},getVehicleState:function(e){return Object(j["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.dispatch,a=e.commit,n=e.getters.vehicle,t.next=3,r("request",{request:[Object(j["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=a,e.next=4,n.getStatus();case 4:e.t1=e.sent,(0,e.t0)("setVehicleData",e.t1),e.next=11;break;case 8:e.prev=8,e.t2=e["catch"](0),setTimeout(Object(j["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r("request",{requests:[[function(){return n.wakeUp()},"唤醒中"],[Object(j["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,5e3)}));case 2:return e.t0=a,e.next=5,n.getStatus();case 5:e.t1=e.sent,(0,e.t0)("setVehicleData",e.t1);case 7:case"end":return e.stop()}}),e)}))),"获取车辆信息"]]});case 2:case"end":return e.stop()}}),e)}))),0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),"获取车辆信息"],retry:!1});case 3:case"end":return t.stop()}}),t)})))()},listVehicles:function(e){return Object(j["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.dispatch,n=e.state,t.next=3,r("request",{request:[Object(j["a"])(regeneratorRuntime.mark((function e(){var t,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.user.listVehicles();case 2:t=n.vehicles=e.sent,n.lastUpdate=Date.now(),i=t.find((function(e){return e.data.vin===n.currentVehicleVin})),!i&&n.currentVehicleVin&&(window.localStorage.removeItem(_e),window.localStorage.removeItem(n.currentVehicleVin),n.currentVehicleVin=null,n.vehicleData={}),!n.currentVehicleVin&&t.length>0&&(i=t[0],window.localStorage.setItem(_e,n.currentVehicleVin=t[0].data.vin),a["a"].set(n,"vehicleData",t[0].data)),i&&"online"===i.data.state&&setTimeout((function(){return r("getVehicleState")}),0);case 8:case"end":return e.stop()}}),e)}))),"获取车辆列表"],show:0===n.vehicles.length});case 3:case"end":return t.stop()}}),t)})))()}}};a["a"].use(c["a"]);var ye=new c["a"].Store({state:{loadingMsg:null,requests:null,error:null},mutations:{setRequests:function(e,t){e.requests=t},setLoading:function(e,t){e.loadingMsg=t,e.error=null,t||(e.requests=null)},setError:function(e,t){e.error=t,e.loadingMsg=null,t||(e.requests=null)}},actions:{request:function(e,t){return Object(j["a"])(regeneratorRuntime.mark((function r(){var a,n,i,s,c,o,l,u,v,d,h,f,p,m;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=e.commit,n=e.state,i=t.requests,s=t.request,c=t.retry,o=void 0===c||c,l=t.show,u=void 0===l||l,i=i||[s],!n.requests){r.next=6;break}return window.console.error("Requests is processing."),r.abrupt("return");case 6:o&&u&&a("setRequests",i),v=Object(y["a"])(i),r.prev=8,v.s();case 10:if((d=v.n()).done){r.next=25;break}return h=Object(me["a"])(d.value,2),f=h[0],p=h[1],m=f(),u&&a("setLoading",p),r.prev=14,r.next=17,m;case 17:r.next=23;break;case 19:return r.prev=19,r.t0=r["catch"](14),u&&a("setError",r.t0),r.abrupt("return");case 23:r.next=10;break;case 25:r.next=30;break;case 27:r.prev=27,r.t1=r["catch"](8),v.e(r.t1);case 30:return r.prev=30,v.f(),r.finish(30);case 33:a("setLoading");case 34:case"end":return r.stop()}}),r,null,[[8,27,30,33],[14,19]])})))()},retry:function(e){return Object(j["a"])(regeneratorRuntime.mark((function t(){var r,a,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.dispatch,a=e.commit,n=e.state,i=n.requests,a("setError",null),t.next=5,r("request",i);case 5:case"end":return t.stop()}}),t)})))()},clearError:function(e){var t=e.commit;t("setError",null)}},modules:{user:je}}),Ve=r("f309");a["a"].use(Ve["a"]);var ke=new Ve["a"]({});a["a"].config.productionTip=!1,a["a"].filter("km",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"number"===typeof e&&(1.609344*e).toFixed(t)+"km"})),a["a"].filter("mile",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"number"===typeof e&&e.toFixed(t)+"mi"})),a["a"].filter("hour",(function(e){if(e){var t=Math.floor(e),r=Math.floor(60*(e-t));return(t&&t+"小时")+(r>0?r+"分钟":"")}})),new a["a"]({router:pe,store:ye,vuetify:ke,render:function(e){return e(_)}}).$mount("#app")},"5d1e":function(e,t,r){"use strict";var a=r("386d"),n=r.n(a);n.a},"683a":function(e,t,r){"use strict";var a=r("1216"),n=r.n(a);n.a}});
//# sourceMappingURL=app.68a24f74.js.map